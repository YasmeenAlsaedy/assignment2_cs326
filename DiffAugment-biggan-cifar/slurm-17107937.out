GNU 6.4.0 is now loaded
{'dataset': 'C10', 'mirror_augment': True, 'num_workers': 8, 'pin_memory': True, 'shuffle': True, 'load_in_mem': False, 'use_multiepoch_sampler': True, 'reset_optim': False, 'load_G_only': False, 'model': 'BigGAN', 'G_param': 'SN', 'D_param': 'SN', 'G_ch': 64, 'D_ch': 64, 'G_depth': 1, 'D_depth': 1, 'D_wide': True, 'G_shared': False, 'fix_G': False, 'shared_dim': 0, 'dim_z': 128, 'z_var': 1.0, 'hier': False, 'cross_replica': False, 'mybn': False, 'G_nl': 'relu', 'D_nl': 'relu', 'G_attn': '0', 'D_attn': '0', 'norm_style': 'bn', 'DiffAugment': 'translation,cutout,color', 'CR_augment': 'flip,translation', 'num_samples': 2500, 'CR': 0, 'seed': 0, 'G_init': 'N02', 'D_init': 'N02', 'skip_init': False, 'G_lr': 0.0002, 'D_lr': 0.0002, 'G_B1': 0.0, 'D_B1': 0.0, 'G_B2': 0.999, 'D_B2': 0.999, 'batch_size': 50, 'G_batch_size': 0, 'num_G_accumulations': 1, 'num_D_steps': 4, 'num_D_accumulations': 1, 'num_epochs': 5000, 'parallel': True, 'G_fp16': False, 'D_fp16': False, 'D_mixed_precision': False, 'G_mixed_precision': False, 'accumulate_stats': False, 'num_standing_accumulations': 16, 'G_eval_mode': False, 'save_every': 2000, 'num_save_copies': 0, 'num_best_copies': 1, 'which_best': 'FID', 'no_fid': False, 'test_every': 4000, 'num_inception_images': 10000, 'hashname': False, 'base_root': '', 'data_root': 'data', 'weights_root': 'weights', 'logs_root': 'logs', 'samples_root': 'samples', 'pbar': 'mine', 'name_suffix': '', 'experiment_name': 'DiffAugment-biggan-cifar10-0.05', 'config_from_name': False, 'ema': True, 'ema_decay': 0.9999, 'use_ema': True, 'ema_start': 1000, 'adam_eps': 1e-08, 'BN_eps': 1e-05, 'SN_eps': 1e-08, 'num_G_SVs': 1, 'num_D_SVs': 1, 'num_G_SV_itrs': 1, 'num_D_SV_itrs': 1, 'G_ortho': 0.0, 'D_ortho': 0.0, 'toggle_grads': True, 'which_train_fn': 'GAN', 'load_weights': '', 'resume_name': None, 'resume': False, 'network': None, 'repeat': 1, 'logstyle': '%3.3e', 'log_G_spectra': False, 'log_D_spectra': False, 'sv_log_interval': 10}
Experiment name is DiffAugment-biggan-cifar10-0.05
Param count for Gs initialized parameters: 4303875
Param count for Ds initialized parameters: 4207361
Preparing EMA for G with decay of 0.9999
Initializing EMA parameters to be source parameters...
Generator(
  (activation): ReLU()
  (shared): identity()
  (linear): SNLinear(in_features=128, out_features=4096, bias=True)
  (blocks): ModuleList(
    (0): ModuleList(
      (0): GBlock(
        (activation): ReLU()
        (conv1): SNConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (conv2): SNConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (conv_sc): SNConv2d(256, 256, kernel_size=(1, 1), stride=(1, 1))
        (bn1): ccbn(
          out: 256, in: 10, cross_replica=False
          (gain): Embedding(10, 256)
          (bias): Embedding(10, 256)
        )
        (bn2): ccbn(
          out: 256, in: 10, cross_replica=False
          (gain): Embedding(10, 256)
          (bias): Embedding(10, 256)
        )
      )
    )
    (1): ModuleList(
      (0): GBlock(
        (activation): ReLU()
        (conv1): SNConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (conv2): SNConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (conv_sc): SNConv2d(256, 256, kernel_size=(1, 1), stride=(1, 1))
        (bn1): ccbn(
          out: 256, in: 10, cross_replica=False
          (gain): Embedding(10, 256)
          (bias): Embedding(10, 256)
        )
        (bn2): ccbn(
          out: 256, in: 10, cross_replica=False
          (gain): Embedding(10, 256)
          (bias): Embedding(10, 256)
        )
      )
    )
    (2): ModuleList(
      (0): GBlock(
        (activation): ReLU()
        (conv1): SNConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (conv2): SNConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (conv_sc): SNConv2d(256, 256, kernel_size=(1, 1), stride=(1, 1))
        (bn1): ccbn(
          out: 256, in: 10, cross_replica=False
          (gain): Embedding(10, 256)
          (bias): Embedding(10, 256)
        )
        (bn2): ccbn(
          out: 256, in: 10, cross_replica=False
          (gain): Embedding(10, 256)
          (bias): Embedding(10, 256)
        )
      )
    )
  )
  (output_layer): Sequential(
    (0): bn()
    (1): ReLU()
    (2): SNConv2d(256, 3, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
  )
)
Discriminator(
  (activation): ReLU()
  (blocks): ModuleList(
    (0): ModuleList(
      (0): DBlock(
        (activation): ReLU()
        (downsample): AvgPool2d(kernel_size=2, stride=2, padding=0)
        (conv1): SNConv2d(3, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (conv2): SNConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (conv_sc): SNConv2d(3, 256, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (1): ModuleList(
      (0): DBlock(
        (activation): ReLU()
        (downsample): AvgPool2d(kernel_size=2, stride=2, padding=0)
        (conv1): SNConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (conv2): SNConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (conv_sc): SNConv2d(256, 256, kernel_size=(1, 1), stride=(1, 1))
      )
    )
    (2): ModuleList(
      (0): DBlock(
        (activation): ReLU()
        (conv1): SNConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (conv2): SNConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
    )
    (3): ModuleList(
      (0): DBlock(
        (activation): ReLU()
        (conv1): SNConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        (conv2): SNConv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      )
    )
  )
  (linear): SNLinear(in_features=256, out_features=1, bias=True)
  (embed): SNEmbedding(10, 256)
)
Number of params in G: 4304387 D: 4207361
Inception Metrics will be saved to logs/DiffAugment-biggan-cifar10-0.05_log.jsonl
logs/DiffAugment-biggan-cifar10-0.05_log.jsonl exists, deleting...
Training Metrics will be saved to logs/DiffAugment-biggan-cifar10-0.05
Using dataset root location data/cifar
Data will be augmented...
Files already downloaded and verified
(2500, 32, 32, 3)
Using multiepoch sampler from start_itr 0...
Beginning training at epoch 0...
Length dataset output is 12500000
1/62500 (  0.00%) logs/DiffAugment-biggan-cifar10-0.05_G_loss.log exists, deleting...
logs/DiffAugment-biggan-cifar10-0.05_D_loss_real.log exists, deleting...
logs/DiffAugment-biggan-cifar10-0.05_D_loss_fake.log exists, deleting...
Deleting singular value logs...
itr: 0, G_loss : +18.809, D_loss_real : +0.116, D_loss_fake : +7.630 Saving weights to weights/DiffAugment-biggan-cifar10-0.05...
Calculating validation accuracy...
Using dataset root location data/cifar
Data will be augmented...
Files already downloaded and verified
/home/alsaedyy/anaconda3/envs/cs326_ass2/lib/python3.6/site-packages/torch/serialization.py:292: UserWarning: Couldn't retrieve source code for container of type ReLU. It won't be checked for correctness upon loading.
  "type " + obj.__name__ + ". It won't be checked "
Calculating training accuracy...
Using dataset root location data/cifar
Data will be augmented...
Files already downloaded and verified
(2500, 32, 32, 3)
Gathering inception metrics...
Traceback (most recent call last):
  File "/home/alsaedyy/anaconda3/envs/cs326_ass2/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1365, in _do_call
    return fn(*args)
  File "/home/alsaedyy/anaconda3/envs/cs326_ass2/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1350, in _run_fn
    target_list, run_metadata)
  File "/home/alsaedyy/anaconda3/envs/cs326_ass2/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1443, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Number of ways to split should evenly divide the split dimension, but got split_dim 0 (size = 50) and num_split 4
	 [[{{node InceptionV3/_Run/split}}]]
  (1) Invalid argument: Number of ways to split should evenly divide the split dimension, but got split_dim 0 (size = 50) and num_split 4
	 [[{{node InceptionV3/_Run/split}}]]
	 [[InceptionV3/_Run/split/_9785]]
0 successful operations.
3 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "train.py", line 257, in <module>
    main()
  File "train.py", line 253, in main
    run(config)
  File "train.py", line 226, in run
    get_inception_metrics, experiment_name, test_log, acc_metrics, acc_itrs)
  File "/ibex/scratch/alsaedyy/cs326_projects/assignment2_cs326/DiffAugment-biggan-cifar/train_fns.py", line 226, in test
    num_splits=10)
  File "/ibex/scratch/alsaedyy/cs326_projects/assignment2_cs326/DiffAugment-biggan-cifar/inception_tf.py", line 54, in get_inception_metrics
    sample, inception_v3_features, inception_v3_softmax, num_inception_images)
  File "/ibex/scratch/alsaedyy/cs326_projects/assignment2_cs326/DiffAugment-biggan-cifar/inception_tf.py", line 75, in accumulate_inception_activations
    num_gpus=num_gpus, assume_frozen=True))
  File "/ibex/scratch/alsaedyy/cs326_projects/assignment2_cs326/DiffAugment-biggan-cifar/dnnlib/tflib/network.py", line 442, in run
    mb_out = tf.get_default_session().run(out_expr, dict(zip(in_expr, mb_in)))
  File "/home/alsaedyy/anaconda3/envs/cs326_ass2/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 956, in run
    run_metadata_ptr)
  File "/home/alsaedyy/anaconda3/envs/cs326_ass2/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1180, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/alsaedyy/anaconda3/envs/cs326_ass2/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1359, in _do_run
    run_metadata)
  File "/home/alsaedyy/anaconda3/envs/cs326_ass2/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1384, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Number of ways to split should evenly divide the split dimension, but got split_dim 0 (size = 50) and num_split 4
	 [[node InceptionV3/_Run/split (defined at /home/alsaedyy/anaconda3/envs/cs326_ass2/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py:1748) ]]
  (1) Invalid argument: Number of ways to split should evenly divide the split dimension, but got split_dim 0 (size = 50) and num_split 4
	 [[node InceptionV3/_Run/split (defined at /home/alsaedyy/anaconda3/envs/cs326_ass2/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[InceptionV3/_Run/split/_9785]]
0 successful operations.
3 derived errors ignored.

Original stack trace for 'InceptionV3/_Run/split':
  File "train.py", line 257, in <module>
    main()
  File "train.py", line 253, in main
    run(config)
  File "train.py", line 226, in run
    get_inception_metrics, experiment_name, test_log, acc_metrics, acc_itrs)
  File "/ibex/scratch/alsaedyy/cs326_projects/assignment2_cs326/DiffAugment-biggan-cifar/train_fns.py", line 226, in test
    num_splits=10)
  File "/ibex/scratch/alsaedyy/cs326_projects/assignment2_cs326/DiffAugment-biggan-cifar/inception_tf.py", line 54, in get_inception_metrics
    sample, inception_v3_features, inception_v3_softmax, num_inception_images)
  File "/ibex/scratch/alsaedyy/cs326_projects/assignment2_cs326/DiffAugment-biggan-cifar/inception_tf.py", line 75, in accumulate_inception_activations
    num_gpus=num_gpus, assume_frozen=True))
  File "/ibex/scratch/alsaedyy/cs326_projects/assignment2_cs326/DiffAugment-biggan-cifar/dnnlib/tflib/network.py", line 403, in run
    in_split = list(zip(*[tf.split(x, num_gpus) for x in in_expr]))
  File "/ibex/scratch/alsaedyy/cs326_projects/assignment2_cs326/DiffAugment-biggan-cifar/dnnlib/tflib/network.py", line 403, in <listcomp>
    in_split = list(zip(*[tf.split(x, num_gpus) for x in in_expr]))
  File "/home/alsaedyy/anaconda3/envs/cs326_ass2/lib/python3.6/site-packages/tensorflow_core/python/ops/array_ops.py", line 1684, in split
    axis=axis, num_split=num_or_size_splits, value=value, name=name)
  File "/home/alsaedyy/anaconda3/envs/cs326_ass2/lib/python3.6/site-packages/tensorflow_core/python/ops/gen_array_ops.py", line 9898, in split
    "Split", split_dim=axis, value=value, num_split=num_split, name=name)
  File "/home/alsaedyy/anaconda3/envs/cs326_ass2/lib/python3.6/site-packages/tensorflow_core/python/framework/op_def_library.py", line 794, in _apply_op_helper
    op_def=op_def)
  File "/home/alsaedyy/anaconda3/envs/cs326_ass2/lib/python3.6/site-packages/tensorflow_core/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/alsaedyy/anaconda3/envs/cs326_ass2/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py", line 3357, in create_op
    attrs, op_def, compute_device)
  File "/home/alsaedyy/anaconda3/envs/cs326_ass2/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py", line 3426, in _create_op_internal
    op_def=op_def)
  File "/home/alsaedyy/anaconda3/envs/cs326_ass2/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

